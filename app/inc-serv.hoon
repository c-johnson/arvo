::  server
=,  ^gall
|%
++  move
  $:  bone
  $%  {$diff $atom @u}
  ==  ==
--
::
=|  mow/(list move)
|_  {bowl dat/(map bone @u)}
++  this  .
++  abet  [(flop mow) .(mow ~)]
++  emit  |=(a/move this(mow [a mow]))
::
++  peer  |=(path abet:update)
++  update  (emit ost %diff %atom get-num)
++  get-num  (fall (~(get by dat) ost) 0)
++  poke-noun
  |=  *
  =<  abet
  ~&  [%poke ost num=get-num]
  =.  dat  (~(put by dat) ost +(get-num))
  ?:  (~(has by sup) ost)
    update
  this
--